# PR Title validation for this repository
# Enforces conventional commit format in PR titles
name: PR Title Lint

on:
  pull_request:
    types: [opened, edited, synchronize, reopened]

concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number }}
  cancel-in-progress: true

permissions:
  contents: read
  pull-requests: read
  statuses: write

jobs:
  lint-pr-title:
    name: Validate PR Title
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
    - name: Validate Semantic PR Title
      uses: amannn/action-semantic-pull-request@0723387faaf9b38adef4775cd42cfd5155ed6017   # v5.5.3
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
          # Standard conventional commit types
        types: |
          build
          chore
          ci
          docs
          feat
          fix
          perf
          refactor
          revert
          style
          test
         # Optional scopes for this repository
        scopes: |
          workflows
          docs
          automation
          governance
          ci
          deps
        requireScope: false
            # Custom error message
        subjectPattern: ^(?![A-Z]).+$
        subjectPatternError: |
          The PR title "{subject}" doesn't match the required format.

          Expected format: <type>(<optional-scope>): <description>

          Examples:
          - feat: add new workflow for issue triage
          - fix(workflows): correct label sync permissions
          - docs: update contributing guidelines
          - chore(deps): bump actions/checkout to v4

          The description must start with a lowercase letter.
