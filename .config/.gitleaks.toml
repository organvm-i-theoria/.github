# Gitleaks configuration for managing false positives
# https://github.com/gitleaks/gitleaks

title = "Gitleaks Configuration for ivviiviivvi/.github"

# Global allowlist for false positives
[allowlist]
  description = "Global allowlist for false positives"

  # Allowlist specific files that contain examples or patterns
  paths = [
    '''\.github/workflows/scan-for-secrets\.yml''',
    '''\.github/workflows/safeguard-5-secret-scanning\.yml''',
    '''docs/SECRETS_SETUP\.md''',
    '''docs/reference/SECURITY_ADVANCED\.md''',
    '''SECURITY_ADVANCED\.md''',
    '''\.github/WORKFLOW_GUIDE\.md''',
    '''WORKFLOW_GUIDE\.md''',
    '''scripts/README\.md''',
    '''agents/.*\.agent\.md''',
    '''\.semgrep/rules\.yml''',
    '''.pre-commit-config.*\.yaml''',
    '''\.config/\.secrets\.baseline''',
  ]

  # Allowlist specific patterns that are examples or documentation
  regexes = [
    '''ghp_xxx''',  # Example token in documentation
    '''AKIA\.\.\.''',  # Example AWS key placeholder
    '''xox[baprs]-\d{10,12}-\d{10,12}-example''',  # Example Slack token
    '''your[-_]?token[-_]?here''',  # Common placeholder
    '''<your.*>''',  # Placeholder format
    '''xxx+''',  # Placeholder
    '''example\.com''',  # Example domains
    '''"hashed_secret":\s*"[a-f0-9]+"''',  # detect-secrets baseline hashed values
  ]

  # Allowlist commits (if needed in the future)
  commits = []

  # Allowlist specific strings that are false positives
  stopwords = [
    "example",
    "sample",
    "placeholder",
    "your-token-here",
    "replace-with",
    "dummy",
  ]

# Extend default rules if needed
[[rules]]
  description = "AWS Access Key"
  id = "aws-access-key"
  regex = '''AKIA[0-9A-Z]{16}'''
  tags = ["key", "AWS"]
  [rules.allowlist]
    description = "Documentation examples"
    regexes = ['''AKIA\.\.\.''']
    paths = ['''docs/.*''', '''README\.md''', '''agents/.*''']

[[rules]]
  description = "GitHub Personal Access Token"
  id = "github-pat"
  regex = '''ghp_[a-zA-Z0-9]{36}'''
  tags = ["key", "GitHub"]
  [rules.allowlist]
    description = "Documentation examples"
    regexes = ['''ghp_xxx''', '''ghp_example''']
    paths = ['''docs/.*''', '''README\.md''', '''scripts/.*''']

[[rules]]
  description = "Generic API Key"
  id = "generic-api-key"
  regex = '''(?i)(api[_-]?key|apikey)["\s:=]+['"']?([a-zA-Z0-9_\-]{20,})['"']?'''
  tags = ["key", "API"]
  [rules.allowlist]
    description = "Workflow and documentation references"
    paths = [
      '''\.github/workflows/.*''',
      '''docs/.*''',
      '''agents/.*''',
    ]

[[rules]]
  description = "Private Key"
  id = "private-key"
  regex = '''-----BEGIN (RSA|DSA|EC|OPENSSH|PGP) PRIVATE KEY-----'''
  tags = ["key", "private"]
  [rules.allowlist]
    description = "Pattern definitions"
    paths = ['''\.github/workflows/.*''', '''agents/.*''']
